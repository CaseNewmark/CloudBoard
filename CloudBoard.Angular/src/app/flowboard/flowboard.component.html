<div class="toolbar-container">
    <toolbar></toolbar>
</div>
@if (!currentCloudBoard) {
    <div class="grow h-full flex justify-center items-center">
        <i>No Cloudboard loaded yet..</i>
    </div>
}
@else {
    <f-flow fDraggable>
        <f-canvas fZoom>
            <!-- Render all connections from the cloudboard data -->
            @for (connector of currentCloudBoard.connections; track connector.id) {
                <f-connection 
                    fType="segment"
                    [fOutputId]="connector.fromConnectorId" 
                    [fInputId]="connector.toConnectorId">
                </f-connection>
            }

            <!-- Render all nodes from the cloudboard data -->
            @for (node of currentCloudBoard.nodes; track node.id) {
                <div 
                    fNode 
                    fDragHandle 
                    [fNodePosition]="node.position"
                    (fNodePositionChange)="onNodePositionChanged($event, node)">
                    <div class="card">
                        <div class="card-header">
                            <h5 class="card-title">{{ node.name }}</h5>
                        </div>
                        <div class="card-body">
                            <p class="card-text"><i>Nothing to see here</i></p>
                            <button type="button" class="btn btn-primary">Edit</button>

                        </div>
                    </div>
                    @for (connector of node.connectors; track connector.id) {
                        @switch (connector.type.toString().toLowerCase()) {
                            @case ('in') {
                                <div fNodeInput [fInputId]="connector.id" class="connector left"></div>
                            }
                            @case ('out') {
                                <div fNodeOutput [fOutputId]="connector.id" class="connector right"></div>
                            }
                            @case ('inout') {
                                <div fNodeInput [fInputId]="connector.id" fNodeOutput [fOutputId]="connector.id" class="connector top"></div>
                            }
                        }
                    }
                </div>
            }
        </f-canvas>
    </f-flow>
}